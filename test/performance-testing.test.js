'use strict';

const assert = require('assert');
const given = require('mocha-testdata');
const SortedUpdatedKeyValueExtractor = require('../lib/extractor/sorted-updated-key-value-extractor');
const OptimizedSortedUpdatedKeyValueExtractor = require('../lib/extractor/optimized-sorted-updated-key-value-extractor');

describe('Print alphabetically Sorted key value pairs from the most updated segment ', () => {

    given(
        [
            [[['dvczk:0',
                'ftttm:0',
                'fuhxr:0',],
                ['aszax:1',
                    'atmij:1',
                    'btzly:1',
                    'ccvgg:1',
                    'cdnoc:1',
                    'dekbf:1',
                    'dnxzq:1',
                    'dnzsq:1',
                    'dtvbx:1',
                    'duyes:1',
                    'dvczk:1',
                    'ftttm:1',
                    'fuhxr:1',
                    'fvtgx:1',
                    'fxqkp:1',
                    'giool:1',
                    'hsgyh:1',
                    'huoql:1',
                    'iciry:1',
                    'imvft:1',
                    'irwkj:1',
                    'jkgpj:1',
                    'jrimf:1',
                    'kbtoo:1',
                    'kcylg:1',
                    'khtad:1',
                    'kivne:1',
                    'kjtlp:1',
                    'kzcio:1',
                    'ldonv:1',
                    'lkleg:1',
                    'mjyki:1',
                    'njqkb:1',
                    'nkjgd:1',
                    'nqpln:1',
                    'nvuir:1',
                    'oadmp:1',
                    'ovaok:1',
                    'piuxb:1',
                    'qeoyg:1',
                    'qnqpj:1',
                    'qpkli:1',
                    'qrpfv:1',
                    'rawzm:1',
                    'rfhtv:1',
                    'rwrzh:1',
                    'rxdyt:1',
                    'sepoe:1',
                    'sjjzc:1',
                    'spatm:1',
                    'suufi:1',
                    'trdiy:1',
                    'tvuzh:1',
                    'uhtbv:1',
                    'vbjqt:1',
                    'vqiqe:1',
                    'vtubd:1',
                    'vxixb:1',
                    'wixpc:1',
                    'xlzxk:1',
                    'xvaka:1',
                    'zdvib:1',
                    'zesau:1',
                    'zggqn:1',
                    'zpneb:1',
                    'zvwoc:1'],
                ['afqto:2',
                    'ccvgg:2',
                    'cdnoc:2',
                    'dnxzq:2',
                    'dnzsq:2',
                    'dvczk:2',
                    'ftttm:2',
                    'fuhxr:2',
                    'htytf:2',
                    'huoql:2',
                    'iciry:2',
                    'irwkj:2',
                    'jkgpj:2',
                    'kcylg:2',
                    'kivne:2',
                    'kjtlp:2',
                    'kzcio:2',
                    'nbfhp:2',
                    'njqkb:2',
                    'nkjgd:2',
                    'nqpln:2',
                    'nvuir:2',
                    'ovaok:2',
                    'qeoyg:2',
                    'qnqpj:2',
                    'qpkli:2',
                    'qrpfv:2',
                    'rawzm:2',
                    'rxdyt:2',
                    'sjjzc:2',
                    'suufi:2',
                    'uhtbv:2',
                    'vbjqt:2',
                    'vqiqe:2',
                    'zesau:2'],
                ['afqto:3',
                    'ccvgg:3',
                    'cdnoc:3',
                    'dnxzq:3',
                    'dvczk:3',
                    'ftttm:3',
                    'htytf:3',
                    'irwkj:3',
                    'kcylg:3',
                    'kivne:3',
                    'kjtlp:3',
                    'kzcio:3',
                    'nbfhp:3',
                    'nkjgd:3',
                    'nqpln:3',
                    'nvuir:3',
                    'ovaok:3',
                    'qpkli:3',
                    'rxdyt:3',
                    'sjjzc:3',
                    'suufi:3',
                    'tlzye:3',
                    'vbjqt:3'],
                ['afqto:4',
                    'bkcxz:4',
                    'ftttm:4',
                    'htytf:4',
                    'nbfhp:4',
                    'nkjgd:4',
                    'nvuir:4',
                    'rxdyt:4',
                    'sjjzc:4',
                    'tlzye:4'],
                ['afqto:5',
                    'aszax:5',
                    'atmij:5',
                    'bkcxz:5',
                    'btzly:5',
                    'ccvgg:5',
                    'cdnoc:5',
                    'dekbf:5',
                    'dnxzq:5',
                    'dnzsq:5',
                    'dtvbx:5',
                    'duyes:5',
                    'dvczk:5',
                    'dwbvs:5',
                    'euhfv:5',
                    'ffxyy:5',
                    'ftttm:5',
                    'fuhxr:5',
                    'fvtgx:5',
                    'fxqkp:5',
                    'fzyqz:5',
                    'gaghl:5',
                    'giool:5',
                    'gpgom:5',
                    'hsgyh:5',
                    'htytf:5',
                    'huoql:5',
                    'iciry:5',
                    'imvft:5',
                    'irwkj:5',
                    'jkgpj:5',
                    'jrimf:5',
                    'jtqxf:5',
                    'kbtoo:5',
                    'kcylg:5',
                    'khtad:5',
                    'kivne:5',
                    'kjtlp:5',
                    'kzcio:5',
                    'ldonv:5',
                    'lkleg:5',
                    'mjyki:5',
                    'nbfhp:5',
                    'njqkb:5',
                    'nkjgd:5',
                    'nqpln:5',
                    'nvuir:5',
                    'oadmp:5',
                    'ovaok:5',
                    'piuxb:5',
                    'qeoyg:5',
                    'qnqpj:5',
                    'qpkli:5',
                    'qrpfv:5',
                    'rawzm:5',
                    'rfhtv:5',
                    'rsudp:5',
                    'rwrzh:5',
                    'rxdyt:5',
                    'sepoe:5',
                    'sjjzc:5',
                    'spatm:5',
                    'suufi:5',
                    'tlzye:5',
                    'trdiy:5',
                    'ttrgg:5',
                    'tvuzh:5',
                    'uhhkx:5',
                    'uhtbv:5',
                    'vbjqt:5',
                    'vqiqe:5',
                    'vtubd:5',
                    'vxixb:5',
                    'wixpc:5',
                    'xlzxk:5',
                    'xvaka:5',
                    'zdvib:5',
                    'zesau:5',
                    'zggqn:5',
                    'zpneb:5',
                    'zvwoc:5'],
                ['ftttm:6', 'nqpln:6', 'nvuir:6', 'sjjzc:6'],
                ['afqto:7',
                    'ccvgg:7',
                    'cdnoc:7',
                    'dnxzq:7',
                    'dnzsq:7',
                    'dvczk:7',
                    'ftttm:7',
                    'fuhxr:7',
                    'htytf:7',
                    'huoql:7',
                    'iciry:7',
                    'irwkj:7',
                    'jkgpj:7',
                    'kcylg:7',
                    'kivne:7',
                    'kjtlp:7',
                    'kzcio:7',
                    'nbfhp:7',
                    'nkjgd:7',
                    'nqpln:7',
                    'nvuir:7',
                    'ovaok:7',
                    'qeoyg:7',
                    'qnqpj:7',
                    'qpkli:7',
                    'qrpfv:7',
                    'rawzm:7',
                    'rxdyt:7',
                    'sjjzc:7',
                    'suufi:7',
                    'tlzye:7',
                    'uhtbv:7',
                    'vbjqt:7',
                    'zesau:7'],
                ['afqto:8',
                    'aszax:8',
                    'atmij:8',
                    'btzly:8',
                    'ccvgg:8',
                    'cdnoc:8',
                    'dekbf:8',
                    'dnxzq:8',
                    'dnzsq:8',
                    'dtvbx:8',
                    'duyes:8',
                    'dvczk:8',
                    'euhfv:8',
                    'ftttm:8',
                    'fuhxr:8',
                    'fvtgx:8',
                    'fxqkp:8',
                    'giool:8',
                    'hsgyh:8',
                    'htytf:8',
                    'huoql:8',
                    'iciry:8',
                    'imvft:8',
                    'irwkj:8',
                    'jkgpj:8',
                    'jrimf:8',
                    'jtqxf:8',
                    'kbtoo:8',
                    'kcylg:8',
                    'khtad:8',
                    'kivne:8',
                    'kjtlp:8',
                    'kzcio:8',
                    'ldonv:8',
                    'lkleg:8',
                    'mjyki:8',
                    'nbfhp:8',
                    'njqkb:8',
                    'nkjgd:8',
                    'nqpln:8',
                    'nvuir:8',
                    'oadmp:8',
                    'ovaok:8',
                    'piuxb:8',
                    'qeoyg:8',
                    'qnqpj:8',
                    'qpkli:8',
                    'qrpfv:8',
                    'rawzm:8',
                    'rfhtv:8',
                    'rsudp:8',
                    'rwrzh:8',
                    'rxdyt:8',
                    'sepoe:8',
                    'sjjzc:8',
                    'spatm:8',
                    'suufi:8',
                    'tlzye:8',
                    'trdiy:8',
                    'tvuzh:8',
                    'uhhkx:8',
                    'uhtbv:8',
                    'vbjqt:8',
                    'vqiqe:8',
                    'vtubd:8',
                    'vxixb:8',
                    'wixpc:8',
                    'xlzxk:8',
                    'xvaka:8',
                    'zdvib:8',
                    'zesau:8',
                    'zggqn:8',
                    'zpneb:8',
                    'zvwoc:8'],
                ['afqto:9',
                    'htytf:9',
                    'nbfhp:9',
                    'nkjgd:9',
                    'rxdyt:9',
                    'sjjzc:9',
                    'tlzye:9'],
                ['afqto:10',
                    'aszax:10',
                    'btzly:10',
                    'ccvgg:10',
                    'cdnoc:10',
                    'dekbf:10',
                    'dnxzq:10',
                    'dnzsq:10',
                    'dtvbx:10',
                    'dvczk:10',
                    'ftttm:10',
                    'fuhxr:10',
                    'fvtgx:10',
                    'fxqkp:10',
                    'hsgyh:10',
                    'htytf:10',
                    'huoql:10',
                    'iciry:10',
                    'imvft:10',
                    'irwkj:10',
                    'jkgpj:10',
                    'kbtoo:10',
                    'kcylg:10',
                    'khtad:10',
                    'kivne:10',
                    'kjtlp:10',
                    'kzcio:10',
                    'mjyki:10',
                    'nbfhp:10',
                    'njqkb:10',
                    'nkjgd:10',
                    'nqpln:10',
                    'nvuir:10',
                    'oadmp:10',
                    'ovaok:10',
                    'piuxb:10',
                    'qeoyg:10',
                    'qnqpj:10',
                    'qpkli:10',
                    'qrpfv:10',
                    'rawzm:10',
                    'rfhtv:10',
                    'rwrzh:10',
                    'rxdyt:10',
                    'sepoe:10',
                    'sjjzc:10',
                    'spatm:10',
                    'suufi:10',
                    'trdiy:10',
                    'tvuzh:10',
                    'uhtbv:10',
                    'vbjqt:10',
                    'vqiqe:10',
                    'vtubd:10',
                    'vxixb:10',
                    'xlzxk:10',
                    'zdvib:10',
                    'zesau:10',
                    'zggqn:10'],
                ['afqto:11',
                    'aszax:11',
                    'atmij:11',
                    'bkcxz:11',
                    'btzly:11',
                    'ccvgg:11',
                    'cdnoc:11',
                    'dekbf:11',
                    'dnxzq:11',
                    'dnzsq:11',
                    'dtvbx:11',
                    'duyes:11',
                    'dvczk:11',
                    'euhfv:11',
                    'ftttm:11',
                    'fuhxr:11',
                    'fvtgx:11',
                    'fxqkp:11',
                    'giool:11',
                    'hsgyh:11',
                    'htytf:11',
                    'huoql:11',
                    'iciry:11',
                    'imvft:11',
                    'irwkj:11',
                    'jkgpj:11',
                    'jrimf:11',
                    'jtqxf:11',
                    'kbtoo:11',
                    'kcylg:11',
                    'khtad:11',
                    'kivne:11',
                    'kjtlp:11',
                    'kzcio:11',
                    'ldonv:11',
                    'lkleg:11',
                    'mjyki:11',
                    'nbfhp:11',
                    'njqkb:11',
                    'nkjgd:11',
                    'nqpln:11',
                    'nvuir:11',
                    'oadmp:11',
                    'ovaok:11',
                    'piuxb:11',
                    'qeoyg:11',
                    'qnqpj:11',
                    'qpkli:11',
                    'qrpfv:11',
                    'rawzm:11',
                    'rfhtv:11',
                    'rsudp:11',
                    'rwrzh:11',
                    'rxdyt:11',
                    'sepoe:11',
                    'sjjzc:11',
                    'spatm:11',
                    'suufi:11',
                    'tlzye:11',
                    'trdiy:11',
                    'tvuzh:11',
                    'uhhkx:11',
                    'uhtbv:11',
                    'vbjqt:11',
                    'vqiqe:11',
                    'vtubd:11',
                    'vxixb:11',
                    'wixpc:11',
                    'xlzxk:11',
                    'xsblf:11',
                    'xvaka:11',
                    'zdvib:11',
                    'zesau:11',
                    'zggqn:11',
                    'zpneb:11',
                    'zvwoc:11'],
                ['aszax:12',
                    'btzly:12',
                    'ccvgg:12',
                    'cdnoc:12',
                    'dekbf:12',
                    'dnxzq:12',
                    'dnzsq:12',
                    'dtvbx:12',
                    'dvczk:12',
                    'ftttm:12',
                    'fuhxr:12',
                    'fvtgx:12',
                    'fxqkp:12',
                    'giool:12',
                    'hsgyh:12',
                    'huoql:12',
                    'iciry:12',
                    'imvft:12',
                    'irwkj:12',
                    'jkgpj:12',
                    'kbtoo:12',
                    'kcylg:12',
                    'khtad:12',
                    'kivne:12',
                    'kjtlp:12',
                    'kzcio:12',
                    'ldonv:12',
                    'mjyki:12',
                    'njqkb:12',
                    'nkjgd:12',
                    'nqpln:12',
                    'nvuir:12',
                    'oadmp:12',
                    'ovaok:12',
                    'piuxb:12',
                    'qeoyg:12',
                    'qnqpj:12',
                    'qpkli:12',
                    'qrpfv:12',
                    'rawzm:12',
                    'rfhtv:12',
                    'rwrzh:12',
                    'rxdyt:12',
                    'sepoe:12',
                    'sjjzc:12',
                    'spatm:12',
                    'suufi:12',
                    'trdiy:12',
                    'tvuzh:12',
                    'uhtbv:12',
                    'vbjqt:12',
                    'vqiqe:12',
                    'vtubd:12',
                    'vxixb:12',
                    'xlzxk:12',
                    'zdvib:12',
                    'zesau:12',
                    'zggqn:12',
                    'zvwoc:12'],
                ['afqto:13',
                    'aszax:13',
                    'btzly:13',
                    'ccvgg:13',
                    'cdnoc:13',
                    'dekbf:13',
                    'dnxzq:13',
                    'dnzsq:13',
                    'dtvbx:13',
                    'dvczk:13',
                    'ftttm:13',
                    'fuhxr:13',
                    'fvtgx:13',
                    'fxqkp:13',
                    'giool:13',
                    'hsgyh:13',
                    'huoql:13',
                    'iciry:13',
                    'imvft:13',
                    'irwkj:13',
                    'jkgpj:13',
                    'kbtoo:13',
                    'kcylg:13',
                    'khtad:13',
                    'kivne:13',
                    'kjtlp:13',
                    'kzcio:13',
                    'ldonv:13',
                    'mjyki:13',
                    'njqkb:13',
                    'nkjgd:13',
                    'nqpln:13',
                    'nvuir:13',
                    'oadmp:13',
                    'ovaok:13',
                    'piuxb:13',
                    'qeoyg:13',
                    'qnqpj:13',
                    'qpkli:13',
                    'qrpfv:13',
                    'rawzm:13',
                    'rfhtv:13',
                    'rwrzh:13',
                    'rxdyt:13',
                    'sepoe:13',
                    'sjjzc:13',
                    'spatm:13',
                    'suufi:13',
                    'trdiy:13',
                    'tvuzh:13',
                    'uhtbv:13',
                    'vbjqt:13',
                    'vqiqe:13',
                    'vtubd:13',
                    'vxixb:13',
                    'xlzxk:13',
                    'zdvib:13',
                    'zesau:13',
                    'zggqn:13',
                    'zvwoc:13'],
                ['afqto:14',
                    'bkcxz:14',
                    'ccvgg:14',
                    'cdnoc:14',
                    'dnxzq:14',
                    'dvczk:14',
                    'ftttm:14',
                    'htytf:14',
                    'kcylg:14',
                    'kivne:14',
                    'nbfhp:14',
                    'nkjgd:14',
                    'nqpln:14',
                    'nvuir:14',
                    'qpkli:14',
                    'rxdyt:14',
                    'sjjzc:14',
                    'suufi:14',
                    'tlzye:14',
                    'xsblf:14']]],
        ]
    ).test('Set: ', function (segments) {

        // SortedUpdatedKeyValueExtractor
        const sortedStartTime = new Date().getTime();
        const sortedUpdatedKeyValueExtractor = new SortedUpdatedKeyValueExtractor(segments, true);
        const sortedUpdatedKeyValueExtractorResult = sortedUpdatedKeyValueExtractor.print(segments);
        const sortedEndTime = new Date().getTime();
        const sortedTotalTime = sortedEndTime - sortedStartTime;

        // OptimizedSortedUpdatedKeyValueExtractor
        const optimizedSortedStartTime = new Date().getTime();
        const optimizedSortedUpdatedKeyValueExtractor = new OptimizedSortedUpdatedKeyValueExtractor(segments, true);
        const optimizedSortedUpdatedKeyValueExtractorResult = optimizedSortedUpdatedKeyValueExtractor.print(segments);
        const optimizedSortedEndTime = new Date().getTime();
        const optimizedSortedTotalTime = optimizedSortedEndTime - optimizedSortedStartTime;

        assert.deepEqual(sortedUpdatedKeyValueExtractorResult, optimizedSortedUpdatedKeyValueExtractorResult, "Results from both extractors should've been equal");
        assert.equal(optimizedSortedTotalTime < sortedTotalTime, true, `optimizedSortedTotalTime: {${optimizedSortedTotalTime}} should've been less than sortedTotalTime: : {${sortedTotalTime}} `);

    });
});